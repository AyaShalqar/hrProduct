================================================================================
                    ПЛАН: БЕЗОПАСНЫЙ ПАРСИНГ LINKEDIN
================================================================================

## JSON vs CSV — что лучше?

CSV:
  + Легко открыть в Excel/Google Sheets
  + Простая структура
  - Проблемы с запятыми/кавычками в данных
  - Только плоская структура

JSON:
  + Поддержка вложенных данных (профиль + навыки + опыт)
  + Легко добавлять новые поля
  + Нет проблем со спецсимволами
  + Легко читать в Python

РЕКОМЕНДАЦИЯ: JSON — если планируешь парсить детали профилей (имя, должность,
навыки), JSON удобнее. Для простого списка ссылок — оба варианта подходят.

================================================================================

## ЗАЩИТА ОТ БАНА — ОСНОВНЫЕ МЕТОДЫ

### 1. СЛУЧАЙНЫЕ ЗАДЕРЖКИ
   - Между страницами: 5-15 секунд (не фиксированные!)
   - Между действиями: 1-3 секунды
   - Иногда делать "длинные паузы" 30-60 сек (имитация чтения)

   Пример:
   ```python
   import random
   time.sleep(random.uniform(5, 15))  # случайная пауза 5-15 сек

   # Иногда делать длинную паузу (имитация чтения профиля)
   if random.random() < 0.1:  # 10% шанс
       time.sleep(random.uniform(30, 60))
   ```

### 2. ЛИМИТЫ НА СЕССИЮ
   - Максимум 50-100 профилей за сессию
   - Максимум 10-20 страниц поиска
   - После лимита — пауза 1-2 часа или следующий день

   Пример:
   ```python
   MAX_PAGES = 15
   MAX_PROFILES = 80

   if page_number >= MAX_PAGES or total_profiles >= MAX_PROFILES:
       print("Достигнут лимит, останавливаемся")
       break
   ```

### 3. ИМИТАЦИЯ ЧЕЛОВЕЧЕСКОГО ПОВЕДЕНИЯ
   - Случайное движение мыши
   - Скролл страницы не мгновенный, а плавный
   - Иногда "промахиваться" мимо кнопки

   Пример скролла:
   ```python
   # Плавный скролл вместо мгновенного
   for _ in range(random.randint(3, 7)):
       page.mouse.wheel(0, random.randint(200, 400))
       time.sleep(random.uniform(0.3, 0.8))
   ```

### 4. РОТАЦИЯ USER-AGENT (опционально)
   ```python
   user_agents = [
       "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)...",
       "Mozilla/5.0 (Windows NT 10.0; Win64; x64)...",
   ]
   context = browser.new_context(
       storage_state="storage_state.json",
       user_agent=random.choice(user_agents)
   )
   ```

### 5. СОХРАНЕНИЕ ПРОГРЕССА
   - Сохранять после каждой страницы (не в конце!)
   - Если бан/ошибка — данные не потеряются
   - Проверять дубликаты перед добавлением

   Пример:
   ```python
   def save_profiles(profiles, filename="profiles.json"):
       with open(filename, "w", encoding="utf-8") as f:
           json.dump(profiles, f, ensure_ascii=False, indent=2)

   # После каждой страницы:
   all_profiles.extend(new_profiles)
   save_profiles(all_profiles)
   ```

### 6. ПРОВЕРКА НА КАПЧУ/БАН
   ```python
   # Проверить есть ли капча или ограничение
   if page.locator("text=security verification").is_visible():
       print("ВНИМАНИЕ: Капча! Остановка.")
       break

   if "challenge" in page.url:
       print("ВНИМАНИЕ: LinkedIn требует верификацию!")
       break
   ```

================================================================================

## СТРУКТУРА JSON ФАЙЛА

Простой вариант (только ссылки):
```json
{
  "search_query": "frontend",
  "location": "Казахстан",
  "collected_at": "2026-02-05",
  "profiles": [
    "https://www.linkedin.com/in/user1/",
    "https://www.linkedin.com/in/user2/"
  ]
}
```

Расширенный вариант (с деталями):
```json
{
  "search_query": "frontend",
  "location": "Казахстан",
  "collected_at": "2026-02-05",
  "profiles": [
    {
      "url": "https://www.linkedin.com/in/user1/",
      "name": "Иван Иванов",
      "title": "Frontend Developer",
      "company": "Google",
      "collected_at": "2026-02-05 14:30:00"
    }
  ]
}
```

================================================================================

## РЕКОМЕНДУЕМЫЕ НАСТРОЙКИ

БЕЗОПАСНЫЙ РЕЖИМ (медленно, но надёжно):
  - Задержка между страницами: 10-20 сек
  - Максимум страниц за сессию: 10
  - Максимум профилей: 50
  - Запуск: 1-2 раза в день

УМЕРЕННЫЙ РЕЖИМ:
  - Задержка между страницами: 5-10 сек
  - Максимум страниц за сессию: 20
  - Максимум профилей: 100
  - Запуск: 2-3 раза в день с перерывами 2+ часа

================================================================================

## ПОРЯДОК РЕАЛИЗАЦИИ

1. Добавить сохранение в JSON после каждой страницы
2. Добавить случайные задержки (random.uniform)
3. Добавить лимиты (MAX_PAGES, MAX_PROFILES)
4. Добавить проверку на капчу/бан
5. Добавить плавный скролл
6. (Опционально) Ротация user-agent

================================================================================
